### Powerview
```
Import-Module .\Powerview.ps1
- Get-NetDomain
	- show domain info
- Get-NetUser
	- Show all user objects + attributes
- Get-NetUser | select cn,pwdlastset,lastlogon
- Get-NetGroup
- Get-NetGroup "Sales Department" | select member
	- Show members of group
- Get-NetComputer
	- pc hostname, OS dnhostname
	- Get-NetComputer | select operatingsystem,dnshostname
		- Good for identifying weaker targets early
- Get-Netsession -computername client74
	- View active user sessions on computer
	- CHECK REGISTRY KEY AS SHOWN IN 21/6 to make sure this is working
	- posloggedon.exe from sysinternalsuite can also do this
		- .\PsLoggedon.exe \\files04
- Get-NetUser -SPN | select samaccountname,serviceprincipalname
	- Find SPNs running in the domain
	- can also use setspn -L iis_service

- Get-ObjectAcl -Identity stephanie
	- Can also use Get-ObjectAcl
	- We want objects with GenericAll; we have full ocntorl over it
		- Get-ObjectAcl -Identity "Management Department" | ? {$_.ActiveDirectoryRights -eq "GenericAll"} | select SecurityIdentifier,ActiveDirectoryRights
	- Can take SIDs and convert them back to their original names 
		- "S-1-5-21-1987370270-658905905-1781884369-512","S-1-5-21-1987370270-658905905-1781884369-1104","S-1-5-32-548","S-1-5-18","S-1-5-21-1987370270-658905905-1781884369-519" | Convert-SidToName
	- Basically want to get group names in AD and check out our ACL permissions against them, can we add ourselves to them?

- Find-DomainShares
	- Find SMB shares on network
	- Can also do:
		- ls \\dc1.corp.com\sysvol\corp.com\
		- cat \\dc1.corp.com\sysvol\corp.com\Policies\oldpolicy\old-policy-backup.xml
```

### Bloodhound/Sharphound
```
Import-Module .\Sharphound.ps1
Invoke-Bloodhound -Collectionmethod all

Find ACtive Sessions:
MATCH p = (c:Computer)-[:HasSession]->(m:User) RETURN p

View all users
MATCH (m: User) RETURN m
```